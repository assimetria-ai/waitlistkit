# ────────────────────────────────────────────────────────────────────────────
# Environment variables — copy this file to .env and fill in the values.
# Never commit .env to git.
# Required vars are marked with (required). Everything else has a safe default.
# ────────────────────────────────────────────────────────────────────────────

# ── Core ─────────────────────────────────────────────────────────────────────
NODE_ENV=development                  # development | test | production
PORT=4000                             # HTTP port the server listens on

# ── Database (required) ───────────────────────────────────────────────────────
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/product_template_dev

# Connection pool tuning (all optional — defaults shown)
DB_POOL_MAX=10                        # Max clients in the pool
DB_POOL_IDLE_TIMEOUT=30000            # ms before an idle client is closed
DB_POOL_CONNECTION_TIMEOUT=2000       # ms to wait for an available client before throwing
DB_POOL_SSL=true                      # Set to "false" to disable SSL even in production

# ── Redis ─────────────────────────────────────────────────────────────────────
REDIS_URL=redis://localhost:6379         # Redis connection URL (default: localhost:6379)

# ── Auth (required) ───────────────────────────────────────────────────────────
# RS256 asymmetric key pair — generate with: npm run generate-keys (from project root)
# Keys are stored as single-line PEM with literal \n between PEM lines.
JWT_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----\n<base64>\n-----END RSA PRIVATE KEY-----
JWT_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----\n<base64>\n-----END PUBLIC KEY-----

# Symmetric encryption keys — also generated by: npm run generate-keys
# Used for encrypting sensitive data at rest (e.g. API keys, OAuth tokens).
ENCRYPT_KEY=
ENCRYPT_IV=

# ── App ───────────────────────────────────────────────────────────────────────
APP_URL=http://localhost:5173          # Frontend origin — used for CORS
SERVER_URL=http://localhost:4000       # Public server URL — used to build OAuth callback URIs

# ── OAuth (optional) ──────────────────────────────────────────────────────────
# Google: console.cloud.google.com > APIs & Services > Credentials
# Callback URL: SERVER_URL/api/auth/google/callback
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# GitHub: github.com/settings/developers > OAuth Apps
# Callback URL: SERVER_URL/api/auth/github/callback
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# ── Stripe ────────────────────────────────────────────────────────────────────
STRIPE_SECRET_KEY=sk_test_...         # stripe.com/dashboard > Developers > API keys
STRIPE_WEBHOOK_SECRET=whsec_...       # stripe.com/dashboard > Developers > Webhooks

# ── AWS / SES (email) ─────────────────────────────────────────────────────────
AWS_REGION=eu-west-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
SES_FROM_EMAIL=noreply@example.com    # Must be a verified SES sender address

# ── AWS / S3 (file storage) ───────────────────────────────────────────────────
S3_BUCKET=                            # e.g. my-product-uploads
S3_ENDPOINT=                          # Optional: MinIO / LocalStack  e.g. http://localhost:9000

# ── SMTP (email — alternative to SES) ────────────────────────────────────────
# Works with Resend, SendGrid, Mailgun, or any SMTP provider.
# If not set, emails are printed to server logs (dev mode).
SMTP_HOST=                            # e.g. smtp.resend.com
SMTP_PORT=587
SMTP_USER=                            # e.g. "resend" for Resend, "apikey" for SendGrid
SMTP_PASS=                            # API key / password
EMAIL_FROM=noreply@example.com        # Sender address shown in email client

# ── AI / LLM (optional) ───────────────────────────────────────────────────────
# Enables /api/ai/openai/* routes (chat, image, embeddings)
OPENAI_API_KEY=                       # platform.openai.com > API keys

# Enables /api/ai/anthropic/* routes (messages, streaming, token count)
ANTHROPIC_API_KEY=                    # console.anthropic.com > API keys

# ── Observability ─────────────────────────────────────────────────────────────
LOG_LEVEL=info                        # trace | debug | info | warn | error | fatal
SERVICE_NAME=server                   # Injected into every log line
ERROR_TRACKING_DSN=                   # Sentry DSN (optional)
