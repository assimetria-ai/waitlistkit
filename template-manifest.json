{
  "version": "1.0.0",
  "generatedAt": "2026-02-26",
  "maintainer": "frederico",
  "description": "Assimetria Product Template — feature manifest. Updated as features are built. Powers the Template Compliance Dashboard in Assimetria OS.",
  "stack": {
    "frontend": "React 18 + Vite + TypeScript + shadcn/ui + Tailwind CSS + Lucide React",
    "backend": "Node.js + Express + pg-promise (PostgreSQL)",
    "auth": "JWT sessions (7-day cookies, httpOnly)",
    "payments": "Stripe",
    "database": "PostgreSQL",
    "logging": "Pino + pino-http"
  },
  "categories": ["auth", "database", "dashboard", "landing", "legal", "referral", "payments", "support", "storage", "devops", "email", "testing", "analytics", "misc"],
  "features": [
    {
      "id": "auth-001",
      "name": "Email/Password Authentication",
      "category": "auth",
      "status": "built",
      "version": "1.0.0",
      "description": "JWT session auth with httpOnly cookie (7-day expiry). Login, register, logout, current-user endpoints. PrivateRoute guards authenticated pages. useAuth hook exposes session state.",
      "files": [
        "server/src/api/@system/sessions/index.js",
        "server/src/lib/@system/Helpers/auth.js",
        "server/src/lib/@system/Helpers/jwt.js",
        "client/src/app/hooks/@system/useAuth.ts",
        "client/src/app/components/@system/PrivateRoute/PrivateRoute.tsx",
        "client/src/app/pages/static/@system/LoginPage.tsx",
        "client/src/app/pages/static/@system/RegisterPage.tsx"
      ]
    },
    {
      "id": "auth-002",
      "name": "OAuth2 Social Login (Google + GitHub)",
      "category": "auth",
      "status": "built",
      "version": "1.0.0",
      "description": "OAuth2 Authorization Code flow for Google and GitHub. No passport dependency — uses native fetch. Finds or creates users, links oauth_accounts table, issues same JWT cookie as email/password auth. OAuthButtons component renders provider buttons on the AuthPage.",
      "files": [
        "server/src/api/@system/oauth/index.js",
        "server/src/lib/@system/OAuth/google.js",
        "server/src/lib/@system/OAuth/github.js",
        "server/src/db/repos/@system/OAuthRepo.js",
        "server/src/db/migrations/@system/004_oauth_accounts.js",
        "client/src/app/components/@system/OAuthButtons/OAuthButtons.tsx",
        "client/src/app/pages/static/@system/AuthPage.tsx"
      ],
      "envVars": [
        "GOOGLE_CLIENT_ID",
        "GOOGLE_CLIENT_SECRET",
        "GITHUB_CLIENT_ID",
        "GITHUB_CLIENT_SECRET",
        "SERVER_URL"
      ]
    },
    {
      "id": "database-001",
      "name": "PostgreSQL Core Schema",
      "category": "database",
      "status": "built",
      "version": "1.0.0",
      "description": "Core tables: users (email, password_hash, role, timestamps), subscriptions (Stripe customer/subscription IDs, plan, status), sessions (token, user_id, expires_at). Migration runner executes @system then @custom migrations in order.",
      "files": [
        "server/src/db/schemas/@system/users.sql",
        "server/src/db/schemas/@system/subscriptions.sql",
        "server/src/db/schemas/@system/sessions.sql",
        "server/src/db/migrations/@system/001_init.js",
        "server/src/db/migrations/@system/002_sessions.js",
        "server/src/db/migrations/@system/run.js",
        "server/src/db/repos/@system/UserRepo.js",
        "server/src/db/repos/@system/SubscriptionRepo.js",
        "server/src/lib/@system/PostgreSQL/index.js"
      ]
    },
    {
      "id": "dashboard-001",
      "name": "Authenticated App Shell",
      "category": "dashboard",
      "status": "built",
      "version": "1.0.0",
      "description": "Post-login app shell with Sidebar navigation, Header, PageLayout wrapper, and HomePage as the main dashboard entry point. PrivateRoute enforces authentication on all /app/* routes.",
      "files": [
        "client/src/app/pages/app/@system/HomePage.tsx",
        "client/src/app/components/@system/Sidebar/Sidebar.tsx",
        "client/src/app/components/@system/Header/Header.tsx",
        "client/src/app/components/@system/layout/PageLayout.tsx",
        "client/src/app/routes/@system/AppRoutes.tsx"
      ]
    },
    {
      "id": "landing-001",
      "name": "Marketing Landing Page",
      "category": "landing",
      "status": "built",
      "version": "1.0.0",
      "description": "Public landing page at / with hero section and CTA. Styled with Tailwind CSS + shadcn/ui. Includes LoginPage (/login), RegisterPage (/register), and NotFoundPage (404 catch-all).",
      "files": [
        "client/src/app/pages/static/@system/LandingPage.tsx",
        "client/src/app/pages/static/@system/LoginPage.tsx",
        "client/src/app/pages/static/@system/RegisterPage.tsx",
        "client/src/app/pages/static/@system/NotFoundPage.tsx"
      ]
    },
    {
      "id": "landing-002",
      "name": "Features Section (Icon Grid)",
      "category": "landing",
      "status": "built",
      "version": "1.0.0",
      "description": "Reusable FeaturesSection component with 6-item icon grid (2-col mobile, 3-col desktop). Accepts optional features, heading, and subheading props for per-product customisation. Default features cover the full @system stack: Vite/React, Auth, Admin, Stripe, PostgreSQL, Docker.",
      "files": [
        "client/src/app/components/@system/FeaturesSection/FeaturesSection.tsx",
        "client/src/app/components/@system/FeaturesSection/index.ts",
        "client/src/app/pages/static/@system/LandingPage.tsx"
      ]
    },
    {
      "id": "payments-001",
      "name": "Stripe Checkout Flow",
      "category": "payments",
      "status": "built",
      "version": "1.1.0",
      "description": "Full Stripe checkout flow: checkout session creation (with optional trial days), customer portal redirect, cancel/uncancel subscription, webhook handler (checkout.session.completed, customer.subscription.updated/deleted, invoice.payment_failed/succeeded), DB sync, /subscriptions/plans endpoint (live Stripe prices), BillingPage (authenticated), PricingPage (public).",
      "files": [
        "server/src/api/@system/stripe/index.js",
        "server/src/api/@system/subscriptions/index.js",
        "server/src/db/repos/@system/SubscriptionRepo.js",
        "server/src/db/schemas/@system/subscriptions.sql",
        "server/src/db/migrations/@system/006_stripe_customer_id.js",
        "server/src/lib/@system/Stripe/index.js",
        "client/src/app/api/@system/stripe.ts",
        "client/src/app/pages/app/@system/BillingPage.tsx",
        "client/src/app/pages/static/@system/PricingPage.tsx",
        "client/src/app/routes/@system/AppRoutes.tsx"
      ],
      "envVars": [
        "STRIPE_SECRET_KEY",
        "STRIPE_WEBHOOK_SECRET",
        "APP_URL"
      ]
    },
    {
      "id": "devops-001",
      "name": "Docker + Railway Deployment",
      "category": "devops",
      "status": "built",
      "version": "1.0.0",
      "description": "Multi-stage Dockerfile (client build + server runtime), docker-compose for local dev, Procfile for Heroku/Railway, railway.json for one-click Railway deployment, setup.sh script.",
      "files": [
        "Dockerfile",
        "docker-compose.yml",
        "docker-compose.local.yml",
        "Procfile",
        "railway.json",
        "scripts/setup.sh"
      ]
    },
    {
      "id": "devops-002",
      "name": "Health Check Endpoints",
      "category": "devops",
      "status": "built",
      "version": "1.0.0",
      "description": "GET /ping (liveness probe) and GET /health (detailed: DB connection, env). Used by Railway/Heroku health checks and monitoring.",
      "files": [
        "server/src/api/@system/ping/index.js",
        "server/src/api/@system/health/index.js"
      ]
    },
    {
      "id": "misc-001",
      "name": "Admin Panel API",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "Admin-only API endpoints for user management and system oversight. Role check middleware gates access to admin routes.",
      "files": [
        "server/src/api/@system/admin/index.js",
        "client/src/app/api/@system/admin.ts",
        "client/src/app/pages/app/@system/@admin/"
      ]
    },
    {
      "id": "misc-002",
      "name": "User Profile",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "GET /user and PATCH /user — fetch and update the authenticated user's own profile.",
      "files": [
        "server/src/api/@system/user/index.js",
        "server/src/db/repos/@system/UserRepo.js"
      ]
    },
    {
      "id": "email-001",
      "name": "Transactional Email (Resend + SMTP + SES)",
      "category": "email",
      "status": "built",
      "version": "2.0.0",
      "description": "Multi-provider email service with pluggable adapters. Provider auto-detected from env vars (priority: Resend native API → SMTP relay → AWS SES → console fallback). Resend adapter uses REST API directly (no SDK, Node 18 fetch). SMTP adapter wraps nodemailer with connection pooling, TLS control, and Resend SMTP relay support. HTML templates (verification, welcome, password_reset, invitation, magic_link, notification) are inline-styled for email client compatibility. All sends tracked in email_logs table. Admin API: GET /api/email/provider, GET /api/email/verify, GET /api/email/quota (SES only), POST /api/email/test.",
      "files": [
        "server/src/lib/@system/Email/index.js",
        "server/src/lib/@system/Email/adapters/resend.js",
        "server/src/lib/@system/Email/adapters/smtp.js",
        "server/src/lib/@system/Email/templates.js",
        "server/src/api/@system/email/index.js",
        "server/src/db/repos/@custom/EmailLogRepo.js",
        "server/test/unit/@system/email.adapters.test.js"
      ],
      "envVars": {
        "resend": ["RESEND_API_KEY", "EMAIL_FROM", "RESEND_REPLY_TO"],
        "smtp": ["SMTP_HOST", "SMTP_PORT", "SMTP_USER", "SMTP_PASS", "EMAIL_FROM", "SMTP_SECURE", "SMTP_POOL"],
        "ses": ["AWS_REGION", "AWS_ACCESS_KEY_ID", "AWS_SECRET_ACCESS_KEY", "SES_FROM_EMAIL"],
        "shared": ["EMAIL_PROVIDER", "APP_URL", "APP_NAME", "SUPPORT_EMAIL"]
      }
    },
    {
      "id": "misc-003",
      "name": "Caching Layer",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "Cache abstraction that delegates to Redis (production) or NodeCache (in-process, no Redis required for dev). Transparent swap via env config.",
      "files": [
        "server/src/lib/@system/Cache/index.js",
        "server/src/lib/@system/Redis/index.js",
        "server/src/lib/@system/NodeCache/index.js"
      ]
    },
    {
      "id": "misc-004",
      "name": "Logging (Pino)",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "Pino logger singleton with pino-http request logging middleware. Structured JSON logs in production, pretty-print in development.",
      "files": [
        "server/src/lib/@system/Logger/index.js"
      ]
    },
    {
      "id": "misc-005",
      "name": "Error Handling",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "AppError class with standardised error codes and HTTP status mappings. Express error middleware converts AppErrors to JSON responses.",
      "files": [
        "server/src/lib/@system/Errors/index.js"
      ]
    },
    {
      "id": "misc-006",
      "name": "Scheduler / Cron Tasks",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "Cron-based scheduler that loads @system tasks (payment retries, subscription sync) and @custom tasks (product-specific jobs) from their respective index.js files.",
      "files": [
        "server/src/scheduler/tasks/@system/index.js",
        "server/src/scheduler/tasks/@custom/index.js"
      ]
    },
    {
      "id": "misc-007",
      "name": "Background Workers",
      "category": "misc",
      "status": "built",
      "version": "1.0.0",
      "description": "Background job processor infrastructure. @system worker base + @custom worker extension point for queue consumers and async jobs.",
      "files": [
        "server/src/workers/@system/index.js",
        "server/src/workers/@custom/index.js"
      ]
    },
    {
      "id": "analytics-001",
      "name": "Analytics Integration (placeholder)",
      "category": "analytics",
      "status": "planned",
      "version": null,
      "description": "PostHog or Google Analytics integration for page views, conversion events, and user behaviour tracking. To be added to client/src/app/lib/@system/.",
      "files": []
    },
    {
      "id": "legal-001",
      "name": "Legal Pages (placeholder)",
      "category": "legal",
      "status": "planned",
      "version": null,
      "description": "Privacy Policy, Terms of Service, Cookie Policy pages in pages/static/@system/. GDPR-compliant cookie consent banner.",
      "files": []
    },
    {
      "id": "referral-001",
      "name": "Referral System (placeholder)",
      "category": "referral",
      "status": "planned",
      "version": null,
      "description": "Referral code generation, tracking, and reward attribution. DB table + API endpoints + client UI.",
      "files": []
    },
    {
      "id": "support-001",
      "name": "Support Integration (placeholder)",
      "category": "support",
      "status": "planned",
      "version": null,
      "description": "Intercom or Crisp chat widget integration in client @system. Support ticket API if needed.",
      "files": []
    },
    {
      "id": "storage-001",
      "name": "File Storage (placeholder)",
      "category": "storage",
      "status": "planned",
      "version": null,
      "description": "AWS S3 or Cloudflare R2 integration for user file uploads. Signed URL generation, multipart upload support.",
      "files": []
    },
    {
      "id": "testing-001",
      "name": "Test Infrastructure",
      "category": "testing",
      "status": "built",
      "version": "1.0.0",
      "description": "Jest test runner with @system/@custom split. Integration tests for API endpoints and unit tests for server utilities.",
      "files": [
        "server/test/api/@system/",
        "server/test/api/@custom/",
        "server/test/unit/@system/",
        "server/test/unit/@custom/"
      ]
    }
  ],
  "architecture": {
    "pattern": "@system/@custom",
    "rules": {
      "system": "Template files shared across ALL products. Managed by Frederico. Synced automatically.",
      "custom": "Product-specific files. Managed per-product. NEVER overwritten during template sync.",
      "sync": "One-click sync updates ALL @system folders from the template GitHub repo. @custom folders are preserved.",
      "autoLoader": "Entry points (index.ts / index.js) auto-merge @system and @custom exports."
    },
    "syncProtocol": {
      "command": "sync-template.sh",
      "workflow": [
        "1. Pull latest template from GitHub",
        "2. For each @system folder: rsync --delete template/@system -> product/@system",
        "3. Skip all @custom folders entirely",
        "4. Run npm install if package.json changed",
        "5. Run migrations if db/migrations/@system/ changed",
        "6. Report what changed"
      ]
    }
  },
  "changelog": [
    {
      "date": "2026-02-26",
      "version": "1.0.0",
      "author": "frederico-junior",
      "changes": "Initial manifest created. Scanned full product-template codebase. Documented all built features with file lists, categories, and status. Added planned features as placeholders for future tracking."
    },
    {
      "date": "2026-02-26",
      "version": "1.0.1",
      "author": "frederico-junior",
      "changes": "Added landing-002: FeaturesSection component (icon grid, 6 features). Extracted from inline LandingPage JSX into a standalone reusable component with optional props."
    },
    {
      "date": "2026-02-26",
      "version": "1.1.0",
      "author": "frederico-junior",
      "changes": "Completed payments-001 Stripe checkout flow: full webhook handler (checkout.session.completed, subscription.updated/deleted, invoice.payment_failed/succeeded), cancel/uncancel endpoints, customer portal, /subscriptions/plans endpoint, stripe_customer_id migration, client stripe.ts API module, BillingPage (live subscription + plan selection), PricingPage (public), /pricing route added."
    },
    {
      "date": "2026-02-26",
      "version": "1.2.0",
      "author": "frederico-junior",
      "changes": "email-001 upgraded to v2.0.0: built pluggable adapter architecture. Resend native REST API adapter (adapters/resend.js) — uses Node 18 fetch, no SDK dependency, supports cc/bcc/reply-to/attachments, verify() health check. SMTP adapter (adapters/smtp.js) — nodemailer wrapper with connection pooling, configurable TLS, works with Resend SMTP relay + SendGrid + Mailgun etc. Email index.js refactored to clean provider-selection logic (resend > smtp > ses > console). Admin API: GET /api/email/verify endpoint added. 29 unit tests — all passing."
    }
  ]
}
